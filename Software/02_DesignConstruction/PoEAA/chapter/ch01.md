# 分層 Layer

- 上層使用下層定義的各種服務, 但下層對上層一無所知
- 每一層通常會對自己的上層隱藏下層的細節

## 優點

- 你無需對其他分層有過多的瞭解, 可以把單一分層當成一個連貫性的整體來理解
- 可以在提供相同服務的前提下, 替換某分層的具體實作
- 能最小化分層之間的依賴關係
- 分層有利於標準化工作
- 一旦建構好某一個分層, 就可以使用它為更多「更高層次的服務」提供支援

## 缺點

- 分層並不是能很好的封裝所有東西
- 過多的分層會損耗效能

> 分層架構中最困難的部分是 __決定要建立哪些層次__, 以及 __每一個分層的責任是什麼__

## 三個主要分層

1. 展示 Presentation
    - 處理使用者與軟體之間的互動
    - 提供服務、顯示資訊
2. 資料來源 Data Source
    - 處理與其他系統的通訊?
    - ex: 資料庫, 訊息佇列系統, 交易管理器, 其他套件
3. 領域 Domain Logic
    - 商業邏輯, 此應用程式需要為你的領域完成的工作    

- 非正式的測試方法: 請想像對系統加入一個安全不同的分層, 例如為 Web App 加入一個命令列. 在此過程中, 如果發現需要 __重複實作__ 任何功能才能完成加入新分層的工作, 就代表有功能放錯地方了.

## 選擇分層的運作地點

- 決定應用程式在哪裡運作?
    - 用戶端
    - 桌上型電腦
    - 伺服器
- 考量因素
    - 升級和修復, 系統維護
    - 部署
    - 同步
    - 相容性
    - 回應能力
    - 斷線, 離線作業
- 除非不得已, 否則不要把「分層」分離並放到多個處理程序之中執行, 這樣做會降低效能又會增加複雜性

