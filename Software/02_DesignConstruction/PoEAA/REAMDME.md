# Patterns of Enterprise Application Architecture

## 序

- 每個設計決策都是一種評估， 一種取捨， 你得找到 __最適合__ 現況各種限制的設計方案。

> 剛好才是最好

- 在選擇架構方案時，別輕視「殺雞用牛刀」所帶來開發、維護、維運、複雜度等問題。
- 應該要避免只是一味追求潮流而忽略了在達到目標的過程中所需考量的限制。

- 考量決策的因素
    - 金錢
    - 時間
    - 團隊技能限制
    - 領域特性
    - 方案延展性
    - 工具服務生態系
    - 人才招募難易度
    - 目標


- __模式__: 將反覆出現的問題, 淬鍊成通用的解決方案

## 前言

- 「架構」不同定義中的共同要素
    1. 將系統最高層次分解成各個部分
    2. 難以改變的決定

- 架構是一個主觀的東西，是一群專業開發人員在一個專案之中，針對一個系統的設計所 __共享的理解__
    - 共享的理解會以「系統的主要元件」以及「它們之間是如何互動的」形式出現

### 企業級應用程式 - 挑戰

- 通常涉及 __持續性資料(persistent data)__ 
    - 需要在程式多次執行之間存在, 使用這些資料的程式也會發生許多變化
- 大量的資料
    - 管理這些資料是系統的主要工作
- 多人同時存取資料的問題
- 使用者介面的畫面
- 鮮少孤立存在, 通常它們需要 __與分散在企業周圍的其他企業級應用程式進行整合__
- 商業流程差異和資料 __概念不一致(conceptual dissonance)__
    - 每個欄位的涵義都可能略有不同
- 不合邏輯的商業邏輯(business logic)
    - 你必須盡可能地有效地組織商業邏輯, 因為唯一確定的是邏輯會隨著時間而改變

- 你能做得最好的事情之一就是透過簡化架構與流程，將一個大型專案轉變成許多小型專案

### 企業級應用程式 - 種類

- 選擇某一種架構也意味著你必須瞭解系統特定的問題, 並且根據當下的理解選擇適當的設計
- 即使你選擇了特定模式, 你也必須修改它來滿足你的需求
- 你不能不經思考就建置企業級軟體, 任何書籍所能做的就是為你提供更多資訊, 作為你做出決策的依據

### 關於效能的考量

- 回應時間 Response Time
    - 系統 __處理__ 來自外部請求所需的時間。 
    - 例如: UI 按鈕, API 呼叫
- 回應能力 Responsiveness
    - 系統 __確認 acknowledge__ 請求的速度。能在處理完成以前 __表示已收到__ 請求。
    - 例如: 檔案複製進度條
- 延遲時間 Latency
    - 獲得 「任何形式的回應」所需的最短時間。
    - 通常無法改善延遲時間, 也是應該盡量減少遠端呼叫的原因     
- 處理能力 Throughput
    - 在給定時間內可以處理請求的能力
    - 例如: 每秒多少bytes, 每秒交易數量(transactions per second, tps)
- 負載 Load 
    - 對系統承受壓力的陳述, 可以透過當前連接到它的使用者數量來衡量    
    - 通常是一些其他測量的環境, 例如 回應時間在不同使用者數量時為多少
- 負載靈敏度 Load Sensitivity
    - 表示回應時間隨著負載的變化程度
    - 使用者增加後, 回應時間增加的幅度
- 效率 Efficiency
    - 按資源劃分的效能
    - 例如: 2個 CPU 取得 30 tps vs. 4個 CPU 取得 40 tps        
- 產能 Capacity
    - 表示最大有效的 __處理能力__ 或 __負載__
    - 可能是一個絕對最大值, 或一個效能降至可接受門檻之上的臨界點

- 可擴充性 Scalability 會測量所加入的資源如何影響效能指標, 通常指硬體
    - 垂直擴充 (Vertical Scalability) 或 垂直縮放 (Scaling Up): 單一伺服器增加更多能力
    - 水平擴充 (Horizontal Scalability) 或 水平縮放 (Scaling Out): 加入更多伺服器    

> 在建置企業級系統的時候, 建置硬體的可擴充性往往比「產能」甚至「效率」來得更有意義

- 如果系統是可擴充的, 加入更多的伺服器通常比加入更多的程式設計師來得便宜

### 模式

- 創造模式的藝術是將許多建議分成相對獨立的區塊, 這樣你就可以參考它們, 且或多或少可以單獨討論它們
- 模式 __源自實踐__, 你需要觀察人們的行為, 觀察有效的事物, 然後尋找「解決方案的核心」, 藉此找到模式。
- 瞭解「模式是什麼」、「它們解決了什麼問題」，以及「它們如何解決問題」。
- 並不需要知道所有細節, 但只要你遇到其中一個問題, 就可以從書中找到對應的模式, 屆時, 再真正深入地瞭解模式
- 模式的價值在於幫助你「傳達」你的想法。
- 模式創造了一套關於「設計」的語彙
- 每個模式都是不完整的, 你有責任在你自己的系統環境中完成它

## Part 1 敘述

1. [分層 Layer](chapter/ch01.md)

## Part 2 模式



