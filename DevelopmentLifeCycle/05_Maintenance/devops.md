

### Virtual Machine

* 縱向擴充: 透過加大CPU、Memory、Disk等方式，完成資源擴充。(多個服務放在同一台虛擬機)

* 橫向擴充: 增加虛擬機數量。(多個服務放在同一台虛擬機，同時有備援機器)

* 微服務時代 (一個服務放一台虛擬機，且同時也具有備援機器)
    * 浪費機器資原
    * 高成本
    * 管理不便
    * 版本升級不容易
    
### 容器化

#### 已解決問題    
    * 升級容易，環境單純: (Docker 服務就是提倡在任何環境快速佈署)(只需要更該「映像檔(image)」版本，即可完成版本升級。)
    * 服務佈署快速: docker-compose.yml + 指令
    * 管理方便

#### 未解決問題
    * 浪費機器資源: 服務主要還是透過「虛擬機」進行劃分, 需要有多台虛擬機
    * 高成本: 得購買足夠的「實體機」數量，避免「虛擬機」數量過多，互搶「實體機」資源。
    
#### 尋求答案
    * 用工具管理龐大數量的 container。(ex: docker swarm、K8S、K3S...)
    * 使用雲端Server
    * 在資源成本足夠的情況，會建議以「實體機」取代「虛擬機」, 不用再花資源在提供機器OS使用
    
### docker command vs docker-compose 

#### 只使用docker command 指令建置的缺點
    * 無法進行版本控制
    * 每當新環境或者新機器需要相同服務時，都必須執行相同指令，容器數量越多時就越難以控制。
    * 當機器死亡時，沒有辦法迅速將服務建置完成
    * 所以 __建議透過 docker-compose.yml 檔案做為版控保留__
    * 每一次調整 docker-compose.yml 後，只需要在重新執行 docker-compose up -d 指令，服務就會重新佈署。
    
### 容器溝通
    * 不建議使用浮動IP溝通, 應該採用__容器名稱__來彼此溝通
    * Container 服務是寫在同一個 docker-compose.yml檔案的話，被建立起來時，網段服務是相同的
    * 如果是不同docker-compose.yml 建立起來的服務, 則是透過建立 network 來溝通
    
### Harbor
    * 儲存團隊私有的 image，Harbor 提供了簡易的 UI 介面，包含權限控管，及跨機器的自動同步功能
    * 類似 Docker Registry
    
### CI/CD 
    * Developer ---git push---> Gitlab
    * Gitlab ---Webhook---> Jenkins
    * Jenkins ---rsyne---> Server
    
#### CI, Continuous Integration 持續整合
    * 程式建置: 開發人員在每一次的 Commit & Push 後，都能夠於統一的環境自動 Build 程式，透過此一步驟可以避免每個開發人員因本機的環境＆套件版本不相同，造成 Service 異常。
    * 程式測試: 當程式編譯完成後，將會透過「單元測試」測試新寫的功能是否正確，或者確認是否有影響到現有功能，透過該步驟進行測試，可以避免掉開發人員遺忘於本機先行檢查，作為「雙重驗證」功用。
    * 目的:
        * 將低人為疏失風險
        * 減少人工手動的反覆步驟
        * 進行版控管制
        * 增加系統一致性與透明化
        * 減少團隊 Loading
        
#### CD, Continuous Deployment 持續佈署
    * 佈署服務: 透過自動化方式，將寫好的程式碼更新到機器上並公開對外服務，另外需要確保套件版本&資料庫資料完整性，也會透過監控系統進行服務存活檢查，若服務異常時會即時發送通知告至開發人員。
    * 目的: 
        * 保持每次更新程式都可順暢完成
        * 確保服務存活
        
#### CICD 工具介紹
    * GitLab (版控工具)
    * GitHub (版控工具)
    * Jenkins (自動化建置工具)
    * Drone (自動化建置工具)
    * Circle (自動化建置工具)
    * Docker (迅速佈署環境工具)
    * K8S (管理 Docker Container 工具)
    * Helm (快速建置各環境 K8S 工具)
    * Grafana (機器數據監控工具)
    * ELK (Log 蒐集工具)
    * Telegram (通訊、錯誤通知工具)
    * Slack (通訊、錯誤通知工具)        
        